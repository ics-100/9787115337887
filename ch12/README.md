## 第 12 章 优化

**学习记录**

* `Thu Sep 17 14:44:26 CST 2020`

### 12.1 何时优化

> 根本不采取优化胜过仓促优化。优化通常会使代码变得难以理解，因为优化会使代码更加复杂。

开发程序时必须关注以下重点

> * 对所有事做好文档记录
> * 确保每一件事都按文档记录完成
> * 代码以模块的形式编写，易于修改


在早期开发过程中优化并非必须进行的操作

> * 轻微的速度问题通常可以通过硬件来解决，这往往比占用程序员的时间更经济。
> * 当修改程序时，应用程序可能会发生很大的变化，因此会浪费你为优化作出的所有努力。
> * 速度问题通常位于代码中的少数位置，而在完成大部分程序前很难找到这些地方。
> 
> 因此，我们往往在开发即将结束时进行优化，这是已经确定代码的正确性，也确定了代码确实存在性能问题。


### 12.2 优化何处

> 一旦确定存在性能问题，你就需要找到问题代码。为此，你可以运行探查器(`profiler`)。探查器可以告诉你程序运行时用于每个`函数的时间`，以及每个`函数的运行次数`。因此利用探查器进行分析能给你所需的信息，让你能够`正确选择要优化的部分`。

### 12.3 局部优化

预先计算 / 记住计算结果(缓存或记忆) / 局部性原理 / 使用寄存器 / 内联函数 / 优化指令 / 寻址方式 / 数据对齐

### 12.4 全局优化

无状态函数（只对传递给它的参数进行操作，没有全局变量或系统调用）是计算机上最容易进行优化的函数类型。

* 并行化
* 无状态(大多数进程并非完全无状态，而是在一定限度内无状态)